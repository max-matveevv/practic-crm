# –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ PracticCRM

## –û–±–∑–æ—Ä

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≥–ª–æ–±–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞—â–∏—â–∞–µ—Ç –≤—Å–µ –º–∞—Ä—à—Ä—É—Ç—ã –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –¥–æ–±–∞–≤–ª—è—Ç—å `ProtectedRoute` –≤ –∫–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
frontend/src/app/
‚îú‚îÄ‚îÄ (public)/           # –ü—É–±–ª–∏—á–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–¥–æ—Å—Ç—É–ø–Ω—ã –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)
‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx      # Layout –¥–ª—è –ø—É–±–ª–∏—á–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü
‚îÇ   ‚îú‚îÄ‚îÄ page.tsx        # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
‚îÇ   ‚îî‚îÄ‚îÄ auth/           # –°—Ç—Ä–∞–Ω–∏—Ü—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
‚îÇ       ‚îî‚îÄ‚îÄ page.tsx    # –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ (protected)/        # –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (—Ç—Ä–µ–±—É—é—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)
‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx      # Layout –¥–ª—è –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü
‚îÇ   ‚îú‚îÄ‚îÄ projects/       # –°—Ç—Ä–∞–Ω–∏—Ü—ã –ø—Ä–æ–µ–∫—Ç–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ tasks/          # –°—Ç—Ä–∞–Ω–∏—Ü—ã –∑–∞–¥–∞—á
‚îú‚îÄ‚îÄ layout.tsx          # –ö–æ—Ä–Ω–µ–≤–æ–π layout
‚îî‚îÄ‚îÄ middleware.ts       # Middleware –¥–ª—è –≥–ª–æ–±–∞–ª—å–Ω–æ–π –∑–∞—â–∏—Ç—ã
```

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### 1. Middleware (`src/middleware.ts`)
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç** –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã
- **–ü—É–±–ª–∏—á–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã**: `/`, `/auth`
- **–ó–∞—â–∏—â–µ–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã**: –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞**: —á–µ—Ä–µ–∑ cookies `auth_token`
- **–†–µ–¥–∏—Ä–µ–∫—Ç**: –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ –≥–ª–∞–≤–Ω—É—é

### 2. Layout —Å–∏—Å—Ç–µ–º–∞
- **`(public)/layout.tsx`**: –¥–ª—è –ø—É–±–ª–∏—á–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü (–≥–ª–∞–≤–Ω–∞—è, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è)
- **`(protected)/layout.tsx`**: –¥–ª—è –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü (–ø—Ä–æ–µ–∫—Ç—ã, –∑–∞–¥–∞—á–∏)
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞—â–∏—Ç–∞**: —á–µ—Ä–µ–∑ `AuthGuard` –≤ protected layout

### 3. AuthGuard (`src/components/auth/AuthGuard.tsx`)
- **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞** –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è** –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- **–†–µ–¥–∏—Ä–µ–∫—Ç** –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **–ó–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ** –≤–æ –≤—Ä–µ–º—è –ø—Ä–æ–≤–µ—Ä–∫–∏

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

### ‚úÖ **–ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**
- –ù–µ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å `ProtectedRoute` –≤ –∫–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞—â–∏—Ç–∞ –≤—Å–µ—Ö –Ω–æ–≤—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü
- –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

### ‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**
- **–î–≤–æ–π–Ω–∞—è –∑–∞—â–∏—Ç–∞**: middleware + AuthGuard
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–æ–≤** –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –∏ –∫–ª–∏–µ–Ω—Ç–µ
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–¥–∏—Ä–µ–∫—Ç** –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### ‚úÖ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**
- **Middleware** —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞
- **–ë—ã—Å—Ç—Ä—ã–π —Ä–µ–¥–∏—Ä–µ–∫—Ç** –±–µ–∑ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** —Å–æ—Å—Ç–æ—è–Ω–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

### ‚úÖ **UX**
- **–ü–ª–∞–≤–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã** –º–µ–∂–¥—É —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏
- **–ó–∞–≥—Ä—É–∑–æ—á–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è** –≤–æ –≤—Ä–µ–º—è –ø—Ä–æ–≤–µ—Ä–∫–∏
- **–ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ** –Ω–∞ –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö

## –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü

### –ü—É–±–ª–∏—á–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
```bash
# –°–æ–∑–¥–∞—Ç—å –≤ –ø–∞–ø–∫–µ (public)
frontend/src/app/(public)/new-page/page.tsx
```

### –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
```bash
# –°–æ–∑–¥–∞—Ç—å –≤ –ø–∞–ø–∫–µ (protected)
frontend/src/app/(protected)/new-page/page.tsx
```

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞—é—Ç –∑–∞—â–∏—Ç—É!** üéâ

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ü—É–±–ª–∏—á–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã
–ò–∑–º–µ–Ω–∏—Ç—å –≤ `src/middleware.ts`:
```typescript
function isPublicRoute(pathname: string): boolean {
  if (pathname === '/') return true
  if (pathname.startsWith('/auth')) return true
  if (pathname.startsWith('/about')) return true  // –ù–æ–≤—ã–π –ø—É–±–ª–∏—á–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç
  return false
}
```

### –¢–æ–∫–µ–Ω—ã
- **localStorage**: –¥–ª—è API –∑–∞–ø—Ä–æ—Å–æ–≤
- **cookies**: –¥–ª—è middleware
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** –º–µ–∂–¥—É –Ω–∏–º–∏

## –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ middleware
```bash
# –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞
document.cookie  # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ auth_token
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è
```typescript
// –í –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ
const { isAuthenticated, user, loading } = useAuth()
console.log({ isAuthenticated, user, loading })
```

## –ú–∏–≥—Ä–∞—Ü–∏—è

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å —Å—Ç–∞—Ä—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å `ProtectedRoute`:

1. **–£–¥–∞–ª–∏—Ç—å** `ProtectedRoute` –∏–∑ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
2. **–ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å** —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤ –ø–∞–ø–∫—É `(protected)`
3. **–£–¥–∞–ª–∏—Ç—å** –∏–º–ø–æ—Ä—Ç—ã `ProtectedRoute`

**–í—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!** üöÄ
